# Story 1.3: Basic UI Framework & Navigation

## Status
Draft

## Story
**As a** user,
**I want** a clean, responsive interface that adapts to different screen sizes,
**so that** I can use the application effectively on my preferred devices.

## Acceptance Criteria
1. Responsive layout system using Tailwind CSS grid
2. Navigation components with active state management
3. Dark/light mode toggle with system preference detection
4. Loading states and error message components
5. Basic accessibility features (ARIA labels, keyboard navigation)
6. Cross-browser compatibility testing and fixes

## Tasks / Subtasks

- [ ] Task 1: Tailwind CSS Setup and Configuration (AC: 1)
  - [ ] Install and configure Tailwind CSS 3.4+ across the web application
  - [ ] Set up PostCSS configuration for Tailwind processing
  - [ ] Configure Tailwind theme with custom design tokens
  - [ ] Set up responsive breakpoints for mobile, tablet, and desktop
  - [ ] Configure utility classes purging for production builds

- [ ] Task 2: Layout System Implementation (AC: 1)
  - [ ] Create responsive grid layout components
  - [ ] Implement flexible container and wrapper components
  - [ ] Create responsive spacing system using Tailwind utilities
  - [ ] Set up responsive typography scaling
  - [ ] Implement responsive image and media handling

- [ ] Task 3: Navigation Framework (AC: 2)
  - [ ] Create primary navigation component with active state management
  - [ ] Implement responsive navigation menu (mobile hamburger, desktop horizontal)
  - [ ] Create breadcrumb navigation components
  - [ ] Set up navigation state management with Zustand
  - [ ] Implement smooth scroll and navigation transitions

- [ ] Task 4: Theme System Implementation (AC: 3)
  - [ ] Create theme context and provider for dark/light mode
  - [ ] Implement system preference detection using `prefers-color-scheme`
  - [ ] Create theme toggle component with smooth transitions
  - [ ] Define color palettes for both light and dark themes
  - [ ] Implement theme persistence in localStorage

- [ ] Task 5: Loading and Error State Components (AC: 4)
  - [ ] Create reusable loading spinner components
  - [ ] Implement skeleton loading components for various content types
  - [ ] Create error message components with different severity levels
  - [ ] Implement toast notification system for user feedback
  - [ ] Create progress indicators for async operations

- [ ] Task 6: Accessibility Implementation (AC: 5)
  - [ ] Implement ARIA labels and roles for all interactive elements
  - [ ] Set up keyboard navigation for all UI components
  - [ ] Implement focus management and visible focus indicators
  - [ ] Add screen reader announcements for dynamic content changes
  - [ ] Ensure color contrast compliance with WCAG 2.1 AA standards

- [ ] Task 7: Cross-Browser Compatibility (AC: 6)
  - [ ] Test application functionality across major browsers (Chrome, Firefox, Safari, Edge)
  - [ ] Implement browser-specific CSS fixes and polyfills
  - [ ] Set up automated cross-browser testing
  - [ ] Fix responsive layout issues on different screen sizes
  - [ ] Validate CSS Grid and Flexbox support across target browsers

## Dev Notes

### Previous Story Insights

Story 1.2 (User Authentication System) established the authentication foundation and basic project structure. The authentication system includes several React components (LoginForm, RegisterForm, ProfileForm) that will need to be integrated into the new UI framework. The existing auth components are located in `apps/web/src/components/features/auth/` and should be styled to match the new design system.

Story 1.2.5 (Environment Setup & Precommit Resolution) ensures that all development dependencies are properly installed and build processes are functioning correctly, providing a solid foundation for implementing the UI framework.

### Technology Stack Context

Based on the technology stack requirements [Source: docs/architecture/tech-stack.md]:

#### Frontend Framework and Styling
- **React**: 18.2+ with TypeScript for component development
- **UI Component Library**: Custom React + Tailwind CSS 3.4+ for unique synth aesthetic
- **State Management**: Zustand 4.4+ for cross-platform state management
- **Animation**: Framer Motion 10.16+ for web animations (30-45 FPS target)
- **Build Tool**: Vite 5.0+ for fast frontend build tool with HMR

#### Design System Requirements
The UI framework should establish the foundation for the future "synth aesthetic" mentioned in the technology stack. While the full synth design system will be developed in later stories, this framework should provide:
- Flexible theming system that can accommodate the future synth design
- Smooth animations and transitions as foundation for synth interactions
- Component structure that supports the future modular game interface

### Component Architecture Requirements

Based on the frontend architecture documentation [Source: docs/architecture-frontend.md]:

#### Component Organization Structure
```
src/components/
├── ui/             # Basic UI elements (Button, Input, Card)
├── forms/          # Form-specific components
├── layout/         # Layout components (Header, Sidebar, Main)
└── features/       # Feature-specific components
    ├── auth/       # Authentication components (existing)
    ├── focus/      # Focus timer components (future)
    ├── tasks/      # Task management components (future)
    └── modules/    # Module assembly components (future)
```

#### Component Standards
Based on coding standards [Source: docs/architecture/coding-standards.md]:

**Naming Conventions**:
- Components: `PascalCase.tsx` (e.g., `UserProfile.tsx`)
- Files: `kebab-case.tsx` (e.g., `focus-timer.tsx`)
- Interfaces: `PascalCase` with `I` prefix (e.g., `IUser`)

**Component Structure Template**:
```typescript
interface ComponentProps {
  // Properly typed props
}

export const Component: React.FC<ComponentProps> = ({
  // Destructured props
}) => {
  // Hooks and state management
  // Event handlers with useCallback
  // Effects with proper dependencies

  return (
    // JSX with proper semantic structure
  );
};
```

### File Locations and Project Structure

Based on the unified project structure [Source: docs/architecture/source-tree.md]:

#### Web Application Structure
```
apps/web/src/
├── components/
│   ├── ui/                    # Basic UI elements (NEW for this story)
│   ├── layout/                # Layout components (NEW for this story)
│   ├── features/
│   │   └── auth/              # Existing auth components
│   ├── hooks/                 # Custom React hooks
│   ├── lib/                   # Utility libraries and configurations
│   ├── pages/                 # Next.js pages (file-based routing)
│   ├── services/              # API client services
│   ├── stores/                # Zustand state management
│   └── styles/                # Global styles and themes (NEW for this story)
```

#### Required New Directories
- `apps/web/src/components/ui/` - Basic UI components (Button, Input, Card, etc.)
- `apps/web/src/components/layout/` - Layout components (Header, Navigation, Main, etc.)
- `apps/web/src/styles/` - Global styles, themes, and Tailwind configuration
- `apps/web/src/hooks/` - Custom hooks for theme and navigation management
- `apps/web/src/stores/` - Zustand stores for UI state management

### State Management Requirements

Based on the frontend architecture [Source: docs/architecture-frontend.md]:

#### UI State Structure
```typescript
// src/stores/types.ts
export interface UIState {
  theme: 'light' | 'dark' | 'system';
  sidebarOpen: boolean;
  navigation: NavigationState;
  loading: LoadingState;
  notifications: NotificationState;
}

export interface NavigationState {
  activeRoute: string;
  breadcrumbs: BreadcrumbItem[];
  menuOpen: boolean;
}

export interface LoadingState {
  global: boolean;
  operations: Record<string, boolean>;
}
```

#### Zustand Store Pattern
```typescript
// src/stores/uiStore.ts
import { create } from 'zustand';
import { devtools, persist } from 'zustand/middleware';

export const useUIStore = create<UIStore>()(
  devtools(
    persist(
      (set, get) => ({
        // Initial state
        theme: 'system',
        sidebarOpen: false,

        // Actions with proper typing
        setTheme: (theme) => set({ theme }, false, 'setTheme'),
        toggleSidebar: () => set((state) => ({ sidebarOpen: !state.sidebarOpen }), false, 'toggleSidebar')
      }),
      {
        name: 'ui-store',
        partialize: (state) => ({ theme: state.theme })
      }
    )
  )
);
```

### Responsive Design Requirements

#### Breakpoint System
Based on Tailwind CSS default breakpoints with custom additions for ADHD-friendly design:

```css
/* Tailwind configuration */
module.exports = {
  theme: {
    screens: {
      'xs': '475px',    /* Small phones */
      'sm': '640px',    /* Large phones */
      'md': '768px',    /* Tablets */
      'lg': '1024px',   /* Small desktops */
      'xl': '1280px',   /* Desktops */
      '2xl': '1536px'   /* Large desktops */
    }
  }
}
```

#### Mobile-First Approach
- Base styles target mobile devices (320px and up)
- Use `min-width` media queries for progressive enhancement
- Ensure touch targets are at least 44px for accessibility
- Implement proper spacing for thumb navigation on mobile

### Accessibility Requirements

Based on coding standards for accessibility [Source: docs/architecture/coding-standards.md]:

#### ARIA Implementation Requirements
- **Semantic HTML**: Use proper HTML5 semantic elements
- **ARIA Labels**: All interactive elements need proper aria-labels or aria-labelledby
- **Role Attributes**: Use appropriate ARIA roles for custom components
- **Screen Reader Support**: Ensure dynamic content changes are announced

#### Keyboard Navigation Requirements
- **Tab Order**: Logical tab navigation through all interactive elements
- **Focus Management**: Visible focus indicators with proper contrast
- **Skip Links**: Skip to main content and skip to navigation links
- **Keyboard Shortcuts**: Common shortcuts (Escape to close modals, Enter to submit forms)

#### Color Contrast Requirements
- **WCAG 2.1 AA**: 4.5:1 contrast ratio for normal text
- **Large Text**: 3:1 contrast ratio for text 18pt+ or 14pt bold
- **Interactive Elements**: Enhanced contrast for buttons and links
- **Focus Indicators**: Visible focus indication with sufficient contrast

### Cross-Browser Compatibility

#### Target Browser Support
Based on technology stack requirements [Source: docs/architecture/tech-stack.md]:
- **Chrome**: Latest 2 versions
- **Firefox**: Latest 2 versions
- **Safari**: Latest 2 versions
- **Edge**: Latest 2 versions

#### CSS Feature Support
- **CSS Grid**: Supported in all target browsers
- **CSS Flexbox**: Supported with prefixes for older browsers
- **Custom Properties**: CSS variables for theming (supported in all targets)
- **Intersection Observer**: For lazy loading and scroll animations

### Integration with Existing Authentication System

#### Auth Component Integration
The existing authentication components need to be styled to match the new design system:

**Existing Components** [Source: docs/architecture/source-tree.md]:
- `apps/web/src/components/features/auth/LoginForm.tsx`
- `apps/web/src/components/features/auth/RegisterForm.tsx`
- `apps/web/src/components/features/auth/ProfileForm.tsx`

**Integration Requirements**:
- Update existing auth components to use new UI components
- Ensure responsive design works on authentication pages
- Apply theme system to auth components
- Integrate auth components into navigation layout
- Maintain existing functionality while updating appearance

### Performance Considerations

Based on performance requirements for ADHD users [Source: docs/architecture/coding-standards.md]:

#### Animation Performance
- **Target Frame Rate**: 30-45 FPS for web animations
- **Animation Library**: Framer Motion 10.16+ for optimized animations
- **GPU Acceleration**: Use transform and opacity for smooth animations
- **Reduced Motion**: Respect `prefers-reduced-motion` setting

#### Loading Performance
- **Critical CSS**: Inline critical CSS for above-the-fold content
- **Lazy Loading**: Implement lazy loading for non-critical components
- **Code Splitting**: Split code by route and feature
- **Image Optimization**: Responsive images with proper sizing

### Testing Requirements

Based on the testing strategy [Source: docs/architecture/tech-stack.md#Testing Strategy]:

#### Frontend Testing Framework
- **Testing Framework**: Vitest 0.34+ for speed and modern features
- **Component Testing**: React Testing Library 13.4+ for component testing
- **E2E Testing**: Playwright 1.40+ for end-to-end testing
- **Coverage Requirement**: 80% minimum coverage for new UI components

#### Test Structure
```
src/components/
├── ui/
│   ├── Button.tsx
│   ├── Button.test.tsx        # Unit tests
│   └── Button.stories.tsx     # Storybook stories (future)
├── layout/
│   ├── Header.tsx
│   ├── Header.test.tsx        # Component tests
│   └── Header.integration.test.tsx  # Integration tests
```

#### Accessibility Testing
- **Automated Testing**: Use axe-core for automated accessibility testing
- **Keyboard Navigation**: Test keyboard navigation flows
- **Screen Reader**: Test with screen reader software
- **Color Contrast**: Validate color contrast ratios

### Configuration Files Required

#### Tailwind Configuration
`apps/web/tailwind.config.js` - Tailwind CSS configuration with custom theme

#### PostCSS Configuration
`apps/web/postcss.config.js` - PostCSS configuration for Tailwind processing

#### TypeScript Path Aliases
Update `apps/web/tsconfig.json` to include path aliases for cleaner imports:
```json
{
  "compilerOptions": {
    "paths": {
      "@/*": ["./src/*"],
      "@/components/*": ["./src/components/*"],
      "@/hooks/*": ["./src/hooks/*"],
      "@/stores/*": ["./src/stores/*"],
      "@/styles/*": ["./src/styles/*"]
    }
  }
}
```

### Success Criteria

The story is complete when:
1. All acceptance criteria are implemented and tested
2. Application is fully responsive across all target devices
3. Dark/light mode toggle works with system preference detection
4. All interactive elements have proper loading and error states
5. Accessibility requirements meet WCAG 2.1 AA standards
6. Cross-browser compatibility is validated for all target browsers
7. Existing authentication components are integrated into new design system
8. Performance targets are met (30-45 FPS animations, sub-200ms interactions)
9. Test coverage meets 80% minimum requirement
10. Build processes complete successfully without errors

## Testing

### Component Testing
- Test all UI components with React Testing Library
- Verify responsive behavior across different viewport sizes
- Test theme switching functionality and persistence
- Validate accessibility attributes and keyboard navigation
- Test error boundaries and loading states

### Integration Testing
- Test navigation component with actual routing
- Integrate theme system with existing authentication components
- Test state management between different UI components
- Validate cross-component interaction and data flow

### Visual Regression Testing
- Set up visual regression testing for UI components
- Test responsive layouts across different screen sizes
- Validate theme consistency across light and dark modes
- Test browser rendering differences

### Accessibility Testing
- Automated accessibility testing with axe-core
- Manual keyboard navigation testing
- Screen reader compatibility testing
- Color contrast validation for both themes

### Performance Testing
- Animation frame rate testing (target: 30-45 FPS)
- Component render performance testing
- Bundle size analysis and optimization
- Core Web Vitals testing (LCP, FID, CLS)

### Cross-Browser Testing
- Manual testing on Chrome, Firefox, Safari, Edge
- Automated cross-browser testing setup
- CSS feature compatibility validation
- Responsive design testing on different devices

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-10-21 | 1.0 | Initial story creation for basic UI framework and navigation | Bob (Scrum Master) |

## Dev Agent Record

### Agent Model Used
[To be filled by development agent]

### Debug Log References
[To be filled by development agent during implementation]

### Completion Notes List
[To be filled by development agent during implementation]

### File List
[To be filled by development agent during implementation]

## QA Results

### Review Date: [Pending review]

### Reviewed By: [Pending review]

### Code Quality Assessment
[Pending QA review]

### Requirements Traceability

| AC # | Requirement | Implementation Status | Test Coverage | Gap Analysis |
|------|-------------|----------------------|---------------|--------------|
| 1 | Responsive layout system using Tailwind CSS grid | [ ] Implemented | [ ] Tested | [ ] |
| 2 | Navigation components with active state management | [ ] Implemented | [ ] Tested | [ ] |
| 3 | Dark/light mode toggle with system preference detection | [ ] Implemented | [ ] Tested | [ ] |
| 4 | Loading states and error message components | [ ] Implemented | [ ] Tested | [ ] |
| 5 | Basic accessibility features (ARIA labels, keyboard navigation) | [ ] Implemented | [ ] Tested | [ ] |
| 6 | Cross-browser compatibility testing and fixes | [ ] Implemented | [ ] Tested | [ ] |

### Security Review
[Pending security review]

### Performance Considerations
[Pending performance review]

### Testing Assessment
[Pending testing review]

### Files Modified During Implementation
[To be filled during development]

### Improvements Checklist
[To be filled during QA review]

### Gate Status
[Pending gate review]

### Recommended Status
[Pending recommendation from QA review]